<html>
<head>
<title>Golem Example</title>
<script src="js/golem.js"></script>
<script src="https://rawgithub.com/mongodb/js-bson/master/browser_build/bson.js"></script>
<script type="text/javascript">
    var conn = new golem.Connection("127.0.0.1:8080/ws", true);

    var BSON = bson().BSON,
    	BSONProtocol = {
        	unpack: function(data) {
            	var doc = BSON.deserialize(new Uint8Array(data));
            	return [doc.e, doc.d];
        	},
        	unmarshal: function(data) {
        		return data;
        	},
        	marshalAndPack: function(name, data) {
        		return BSON.serialize({ e: name, d: data }, false, true, false);
        	}
    };

    conn.enableBinary();
    conn.setProtocol(BSONProtocol);

    conn.on("answer", function(data) {
        console.log("Answer: "+data.msg);
    });

    conn.on("open", function() {
        console.log("example: Emitting hello and poke.");
        conn.emit("hello", { to: "Server", from: "Client" });
        conn.emit("poke");
    });
</script>
</head>
<body>
</body>
</html>